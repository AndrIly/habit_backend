#  Habit Tracker Telegram bot
Telegram-бот для трекинга привычек с авторизацией через Telegram WebApp и backend на FastAPI.

## Цель проекта

Разработать Telegram-бота для трекинга привычек с backend на FastAPI и авторизацией через Telegram WebApp.
Проект демонстрирует работу с Telegram Bot API, клиент–серверную архитектуру и хранение данных пользователей.

### Как работает бот

### Авторизация пользователей

1. **Пользователь нажимает кнопку входа в боте**
   - Бот отправляет кнопку типа **WebApp** (открывает мини-приложение).

2. **Открывается WebApp**
   - Внутри WebApp вызывается:
     - `Telegram.WebApp.ready()`
     - берётся `tg.initData` (строка с данными пользователя + подписью)

3. **WebApp отправляет `initData` на backend**
   - WebApp делает `POST` запрос на backend, например:
     - `/auth/telegram-webapp`
   - В body передаётся `init_data`.

4. **Backend проверяет подлинность `initData`**
   Backend:
   - парсит `initData`
   - валидирует подпись (HMAC по правилам Telegram)
   - проверяет актуальность `auth_date` (чтобы данные не были “старыми”)
   - достаёт `user` (id, username и т.д.)

5. **Backend создаёт сессию**
   - после успешной проверки backend создаёт `session_id` (или JWT/токен)
   - сохраняет связку `telegram_user_id → session_id` в БД (или в памяти)
   - возвращает `session_id` обратно в WebApp

6. **WebApp передаёт `session_id` обратно в бота**
   - WebApp отправляет результат в Telegram через:
     - `Telegram.WebApp.sendData(...)`
   - в `sendData` кладём JSON с `session_id`

7. **Бот получает `web_app_data`**
   - бот ловит `message.web_app_data`
   - парсит JSON
   - сохраняет `session_id` для пользователя
   - отправляет сообщение: “✅ Авторизация прошла успешно!”
  
   Таким образом, авторизация происходит без логинов и паролей.
Подлинность пользователя гарантируется Telegram, а backend получает надёжный идентификатор пользователя для дальнейшей работы.



### База данных 

В проекте используется база данных для хранения пользователей и их привычек.  
База нужна, чтобы данные не терялись между перезапусками бота/сервера и чтобы backend мог безопасно связывать действия с конкретным Telegram-пользователем.
База данных реализована на SQLite и инициализируется автоматически при запуске приложения.

#### Что хранится в базе

- **Пользователи** (Telegram ID, username и т.д.)
- **Сессии авторизации** (если используется `session_id` / токен)
- **Привычки** (название, расписание/частота, статус и служебные поля)

### Er-диаграма
![Er-Диаграмма](images/er-diagrama.png)
Все сущности связаны через `telegram_user_id`, что позволяет однозначно идентифицировать пользователя.


### Используемые библиотеки

pyTelegramBotAPI==4.30.0
python-dotenv== 1.2.1
fastapi == 0.128.0
uvicorn == 0.40.0
schedule == 1.2.2
PyJWT == 2.11.0
starlette == 0.50.0

Полный список зависимостей указан в `requirements.txt`.


### Пользовательский сценарий

1. Пользователь открывает бота
2. Авторизуется через WebApp
3. Создаёт привычку
4. Получает напоминания
5. Отмечает выполнение


## Автор

Илья
tg - @iliychAndr
Python Developer




